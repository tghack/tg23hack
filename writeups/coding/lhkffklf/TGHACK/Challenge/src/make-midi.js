'use strict';

// who doesn't like inlining binary data in code...
const midi = Buffer.from('TVRoZAAAAAYAAQACAIBNVHJrAAAJroQAkEFAIIBBQCCQRUAggEVAIJBIQCCASEAgkEpAIIBKQCCQS0AggEtAIJBLQCCAS0AAkEpAQIBKQACQSEAggEhAAJBGQCCARkAgkD5AAJBBQACQRkAggD5AAIBBQACARkBAkDxAAJBBQACQRUCBAIA8QACAQUAAgEVAIJA+QACQQUAAkEZAIIA+QACAQUAAgEZAQJA8QACQQUAAkEVAgQCAPEAAgEFAAIBFQCCQQUAggEFAIJBFQCCARUAgkEhAIIBIQCCQSkAggEpAIJBLQCCAS0AgkEtAIIBLQACQSkBAgEpAAJBIQCCASEAAkEZAIIBGQCCQQ0AAkEZAAJBLQCCAQ0AAgEZAAIBLQECQQUAAkEZAAJBKQIEAgEFAAIBGQACASkAgkENAAJBGQACQS0AggENAAIBGQACAS0BAkEFAAJBGQACQSkCBAIBBQACARkAAgEpAYJBDQCCAQ0AgkEZAIIBGQCCQSkAggEpAIJBKQECASkBAkEhAgQCASEBAkEZAAJBKQCCARkAAgEpAIJBGQACQTUAggEZAAIBNQCCQRkAAkE9AIIBGQACAT0AgkEhAAJBMQACQUUBAgEhAAIBMQACAUUAgkEhAAJBMQACQT0BAgEhAAIBMQACAT0AAkE1AIIBNQACQSkBAgEpAAJBFQACQSEAAkE1AIIBFQACASEAAgE1AIJBFQACQSEAAkE1AQIBFQACASEAAgE1AIJBIQCCASEAAkFFAAJBUQECAUUAAgFRAAJBNQACQUUAggE1AAIBRQIFgkERAAJBNQCCAREAAgE1AIJBEQACQS0AggERAAIBLQCCQREAAkElAIIBEQACASUAgkERAAJBLQCCAREAAgEtAIJBDQACQRkAAkE1AIIBDQACARkAAgE1AIJBDQACQRkAAkEtAIIBDQACARkAAgEtAIJBDQACQRkAAkElAIIBDQACARkAAgElAIJBDQACQRkAAkEtAIIBDQACARkAAgEtAIJBFQACQSEAAkE1AIIBFQACASEAAgE1AIJBFQACQSEAAkE1AQIBFQACASEAAgE1AIJBIQCCASEAAkFFAAJBUQECAUUAAgFRAAJBNQACQUUAggE1AAIBRQIFgkE1AAJBQQACQWUAggE1AAIBQQACAWUAgkEtAAJBPQACQV0AggEtAAIBPQACAV0AgkElAAJBNQACQVUAggElAAIBNQACAVUAgkEtAAJBPQACQV0AggEtAAIBPQACAV0AgkE1AAJBQQACQWUAggE1AAIBQQACAWUAgkEtAAJBPQACQV0AggEtAAIBPQACAV0AgkElAAJBNQACQVUAggElAAIBNQACAVUAgkEtAAJBPQACQV0AggEtAAIBPQACAV0AgkE1AAJBRQACQTUAggE1AAIBRQACATUAgkE1AAJBRQACQTUBAgE1AAIBRQACATUAgkFRAIIBUQACQXUAAkGBAQIBdQACAYEAAkFlAAJBdQCCAWUAAgF1AggCQRUAAkEpAAJBNQCCARUAAgEpAAIBNQACQRUAAkEpAAJBNQCCARUAAgEpAAIBNQACQRUAAkEpAAJBNQCCARUAAgEpAAIBNQACQRUAAkEpAAJBRQECARUAAgEpAAIBRQACQRUAAkEpAAJBNQECARUAAgEpAAIBNQACQQUAAkEhAQIBBQACASEAAkEFAAJBIQECAQUAAgEhAAJBIQACQSkBAgEhAAIBKQACQSEAAkE1AQIBIQACATUBAkEZAAJBLQACQTUAggEZAAIBLQACATUAAkEZAAJBLQACQTUAggEZAAIBLQACATUAAkEZAAJBLQACQUUBAgEZAAIBLQACAUUAAkEZAAJBLQACQTUBAgEZAAIBLQACATUAAkEhAAJBNQACQUUBAgEhAAIBNQACAUUAAkEpAAJBNQACQUkBAgEpAAIBNQACAUkAAkEhAAJBNQACQUUBAgEhAAIBNQACAUUAAkEVAAJBIQACQTUBAgEVAAIBIQACATUBAkEhAAJBMQACQT0AggEhAAIBMQACAT0AAkEhAAJBMQACQT0AggEhAAIBMQACAT0AAkEhAAJBMQACQT0BAgEhAAIBMQACAT0AAkEhAAJBMQACQUUBAgEhAAIBMQACAUUAAkExAAJBTQACQVkBAgExAAIBTQACAVkAAkExAAJBRQACQVkBAgExAAIBRQACAVkAAkExAAJBPQACQWEBAgExAAIBPQACAWEAAkExAAJBRQACQVkBAgExAAIBRQACAVkAAkE9AAJBTQACQVkAggE9AAIBTQACAVkAgkE9AAJBTQACQVkBAgE9AAIBTQACAVkAgkExAIIBMQACQU0AAkFZAQIBTQACAVkAAkE9AAJBTQCCAT0AAgFNAIJBPQCCAT0AgkFNAIIBTQACQVkAggFZAAJBYQCCAWEAAkFtAIIBbQACQT0BAgE9AAJBNQECATUAAkEZAAJBLQCCARkAAgEtAIJBGQACQTUAggEZAAIBNQCCQRUAAkEhAAJBPQCCARUAAgEhAAIBPQCCQRUAAkEhAAJBNQCCARUAAgEhAAIBNQCCQRUAAkEhAAJBLQCCARUAAgEhAAIBLQCCQRUAAkEhAAJBNQCCARUAAgEhAAIBNQCCQR0AAkEpAAJBPQCCAR0AAgEpAAIBPQCCQR0AAkEpAAJBPQECAR0AAgEpAAIBPQCCQSkAggEpAAJBTQACQVkBAgFNAAIBWQACQT0AAkFNAIIBPQACAU0AgkE9AIIBPQCCQU0AggFNAAJBWQCCAVkAAkFhAIIBYQACQW0AggFtAAJBPQECAT0AAkE1AQIBNQACQRkAAkEtAIIBGQACAS0AgkEZAAJBNQCCARkAAgE1AIJBGQACQT0BAgEZAAIBPQACQRUAAkE1AQIBFQACATUAAkENAAJBLQCCAQ0AAgEtAIJBFQACQTUAggEVAAIBNQCCQRUAAkEhAAJBPQECARUAAgEhAAIBPQACQTUAggE1AIJBFQACQSEAAkEtAIIBFQACASEAAgEtAIJBFQACQSEAAkE1AIIBFQACASEAAgE1AIJBFQACQSEAAkE9AQIBFQACASEAAgE9AAJBNQCCATUAgkEVAAJBIQACQS0AggEVAAIBIQACAS0AgkEVAAJBIQACQTUAggEVAAIBIQACATUAgkEdAAJBKQACQT0AggEdAAIBKQACAT0AgkEdAAJBKQACQT0BAgEdAAIBKQACAT0AgkEpAIIBKQACQU0AAkFZAQIBTQACAVkAAkE9AAJBTQCCAT0AAgFNAYJBPQACQU0AAkFZAAJBbQIEAgE9AAIBTQACAVkAAgFtAAP8vAE1UcmsAAAYlAJApQCCAKUAgkDVAIIA1QCCQKUAggClAIJA1QCCANUAgkClAIIApQCCQNUAggDVAAJApQCCAKUAgkClAIIApQACQNUAggDVAIJApQCCAKUAgkDVAIIA1QCCQKUAggClAIJA1QCCANUAgkClAIIApQCCQNUAggDVAAJApQCCAKUAgkClAIIApQACQNUAggDVAIJApQCCAKUAgkDVAIIA1QCCQKUAggClAIJA1QCCANUAgkClAIIApQCCQNUAggDVAAJApQCCAKUAgkClAIIApQACQNUAggDVAIJApQCCAKUAgkDVAIIA1QCCQKUAggClAIJA1QCCANUAgkClAIIApQCCQNUAggDVAAJApQCCAKUAgkClAIIApQACQNUAggDVAIJAuQCCALkAgkDpAIIA6QCCQLkAggC5AIJA6QCCAOkAgkC5AIIAuQCCQOkAggDpAAJAuQCCALkAgkC5AIIAuQACQOkAggDpAIJArQCCAK0AgkDdAIIA3QCCQK0AggCtAIJA3QCCAN0AgkDBAIIAwQCCQPEAggDxAAJAwQCCAMEAgkDBAIIAwQACQPEAggDxAIJArQCCAK0AgkDdAIIA3QCCQK0AggCtAIJA3QCCAN0AgkDBAIIAwQCCQPEAggDxAAJAwQCCAMEAgkDBAIIAwQACQPEAggDxAIJApQCCAKUAgkDVAIIA1QCCQKUAggClAIJA1QCCANUAgkClAIIApQCCQNUAggDVAAJApQCCAKUAgkClAIIApQACQNUAggDVAIJAxQCCAMUAgkD1AIIA9QCCQMUAggDFAIJA9QCCAPUAgkDNAIIAzQCCQP0AggD9AIJAzQCCAM0AgkD9AIIA/QCCQKUAggClAIJA1QCCANUAgkClAIIApQCCQNUAggDVAIJApQCCAKUAgkDVAIIA1QACQKUAggClAIJApQCCAKUAAkDVAIIA1QCCQMUAggDFAIJA9QCCAPUAgkDFAIIAxQCCQPUAggD1AIJAzQCCAM0AgkD9AIIA/QCCQM0AggDNAIJA/QCCAP0AgkClAIIApQCCQNUAggDVAIJApQCCAKUAgkDVAIIA1QCCQKUAggClAIJA1QCCANUAAkClAIIApQCCQKUAggClAAJA1QCCANUAgkCtAAJA3QECAK0AAgDdAIJA3QCCAN0AAkD5AAJBDQECAPkAAgENAAJA3QECAN0AAkC1AAJA5QECALUAAgDlAIJA5QCCAOUAAkEFAAJBFQECAQUAAgEVAAJA5QECAOUAAkCdAAJAzQECAJ0AAgDNAIJAzQCCAM0AAkDpAAJA/QECAOkAAgD9AAJAzQECAM0AAkClAAJA1QECAKUAAgDVAIJA1QCCANUAAkDxAAJBBQECAPEAAgEFAAJA1QECANUAAkDJAAJA+QECAMkAAgD5AAJAyQACQPkBAgDJAAIA+QACQMkAAkD5AQIAyQACAPkAAkDJAAJA+QECAMkAAgD5AAJAmQACQMkBAgCZAAIAyQACQJkAAkDJAQIAmQACAMkAAkCZAAJAyQECAJkAAgDJAAJAmQACQMkBAgCZAAIAyQACQK0AggCtAIJA3QCCAN0AgkCtAIIArQCCQN0AggDdAIJArQCCAK0AgkDdAIIA3QACQK0AggCtAIJArQCCAK0AAkDdAIIA3QCCQJ0AggCdAIJAzQCCAM0AgkCdAIIAnQCCQM0AggDNAIJApQCCAKUAgkDVAIIA1QCCQKUAggClAIJA1QCCANUAgkCtAIIArQCCQN0AggDdAIJArQCCAK0AgkDdAIIA3QCCQK0AggCtAIJA3QCCAN0AAkCtAIIArQCCQK0AggCtAAJA3QCCAN0AgkCdAIIAnQCCQM0AggDNAIJAnQCCAJ0AgkDNAIIAzQCCQJ0AggCdAIJAzQCCAM0AgkCdAIIAnQCCQM0AggDNAIJApQCCAKUAgkDVAIIA1QCCQKUAggClAIJA1QCCANUAgkClAIIApQCCQNUAggDVAIJApQCCAKUAgkDVAIIA1QCCQK0AAkDdAIIArQACAN0AgkCtAAJA3QCCAK0AAgDdAYJAyQECAMkAAkDdAIIA3QGCQK0AAkDdAgQCAK0AAgDdAAP8vAA==', 'base64');
const is = [
  26, 30, 34, 38, 42, 46, 50, 54, 58, 62, 66, 70, 74, 78, 82, 86, 90, 94, 98,
  102, 106, 110, 114, 118, 122, 126, 130, 135, 139, 143, 147, 151, 155, 159,
  163, 167, 171, 175, 179, 184, 188, 192, 196, 200, 204, 208, 212, 216, 220,
  224, 228, 232, 236, 240, 244, 248, 252, 256, 260, 264, 268, 272, 276, 280,
  284, 288, 292, 296, 300, 305, 309, 313, 317, 321, 325, 329, 333, 337, 341,
  345, 349, 354, 358, 362, 366, 370, 374, 378, 382, 386, 390, 394, 398, 403,
  407, 411, 415, 419, 423, 427, 431, 435, 439, 443, 447, 451, 455, 459, 463,
  467, 471, 475, 479, 483, 487, 491, 495, 499, 503, 507, 511, 515, 519, 523,
  527, 531, 535, 539, 543, 547, 551, 555, 559, 563, 567, 571, 575, 579, 583,
  587, 591, 595, 599, 603, 608, 612, 616, 620, 624, 628, 632, 636, 640, 644,
  648, 652, 656, 660, 664, 668, 672, 676, 680, 684, 688, 692, 696, 700, 704,
  708, 712, 716, 720, 724, 728, 732, 736, 740, 744, 748, 752, 756, 760, 764,
  768, 772, 776, 780, 784, 788, 792, 796, 800, 804, 808, 812, 816, 820, 824,
  828, 832, 836, 840, 844, 848, 852, 857, 861, 865, 869, 873, 877, 881, 885,
  889, 893, 897, 901, 905, 909, 913, 917, 921, 925, 929, 933, 937, 941, 945,
  949, 953, 957, 961, 965, 969, 973, 977, 981, 985, 989, 993, 997, 1001, 1005,
  1009, 1013, 1017, 1021, 1025, 1029, 1033, 1037, 1041, 1045, 1049, 1053, 1057,
  1061, 1065, 1069, 1073, 1077, 1081, 1085, 1089, 1093, 1097, 1101, 1105, 1109,
  1113, 1117, 1121, 1125, 1129, 1133, 1138, 1142, 1146, 1150, 1154, 1158, 1162,
  1166, 1170, 1174, 1178, 1182, 1186, 1190, 1194, 1198, 1202, 1206, 1210, 1214,
  1218, 1222, 1226, 1230, 1234, 1238, 1242, 1246, 1250, 1254, 1258, 1262, 1266,
  1270, 1274, 1278, 1282, 1286, 1290, 1294, 1298, 1302, 1306, 1310, 1314, 1318,
  1322, 1326, 1330, 1334, 1338, 1342, 1346, 1350, 1354, 1358, 1362, 1366, 1370,
  1374, 1378, 1382, 1386, 1390, 1394, 1398, 1402, 1406, 1410, 1414, 1418, 1422,
  1426, 1430, 1434, 1438, 1442, 1446, 1450, 1454, 1458, 1462, 1466, 1470, 1474,
  1478, 1482, 1486, 1490, 1494, 1498, 1502, 1506, 1510, 1514, 1518, 1522, 1526,
  1530, 1534, 1538, 1542, 1546, 1550, 1554, 1558, 1562, 1566, 1570, 1574, 1578,
  1582, 1586, 1590, 1594, 1598, 1602, 1606, 1610, 1614, 1618, 1622, 1626, 1630,
  1634, 1638, 1642, 1646, 1650, 1654, 1658, 1662, 1666, 1670, 1674, 1678, 1682,
  1686, 1690, 1694, 1698, 1702, 1706, 1710, 1714, 1718, 1722, 1726, 1730, 1734,
  1738, 1742, 1746, 1750, 1754, 1758, 1762, 1766, 1770, 1774, 1778, 1782, 1786,
  1790, 1794, 1798, 1802, 1806, 1810, 1814, 1818, 1822, 1826, 1830, 1834, 1838,
  1842, 1846, 1850, 1854, 1858, 1862, 1866, 1870, 1874, 1878, 1882, 1886, 1890,
  1894, 1898, 1902, 1906, 1910, 1914, 1918, 1922, 1926, 1930, 1934, 1938, 1942,
  1946, 1950, 1954, 1958, 1962, 1966, 1970, 1974, 1978, 1982, 1986, 1990, 1994,
  1998, 2002, 2006, 2010, 2014, 2018, 2022, 2026, 2030, 2034, 2038, 2042, 2046,
  2050, 2054, 2058, 2062, 2066, 2070, 2074, 2078, 2082, 2086, 2090, 2094, 2098,
  2102, 2106, 2110, 2114, 2118, 2122, 2126, 2130, 2134, 2138, 2142, 2146, 2150,
  2154, 2158, 2162, 2166, 2170, 2174, 2178, 2182, 2186, 2190, 2194, 2198, 2202,
  2206, 2210, 2214, 2218, 2222, 2226, 2230, 2234, 2238, 2242, 2246, 2250, 2254,
  2258, 2262, 2266, 2270, 2274, 2278, 2282, 2286, 2290, 2294, 2298, 2302, 2306,
  2310, 2314, 2318, 2322, 2326, 2330, 2334, 2338, 2342, 2346, 2350, 2354, 2358,
  2362, 2366, 2370, 2374, 2378, 2382, 2386, 2390, 2394, 2398, 2402, 2406, 2410,
  2414, 2418, 2422, 2426, 2430, 2434, 2438, 2442, 2446, 2450, 2454, 2458, 2462,
  2466, 2470, 2474, 2478, 2483, 2487, 2491, 2495, 2511, 2515, 2519, 2523, 2527,
  2531, 2535, 2539, 2543, 2547, 2551, 2555, 2559, 2563, 2567, 2571, 2575, 2579,
  2583, 2587, 2591, 2595, 2599, 2603, 2607, 2611, 2615, 2619, 2623, 2627, 2631,
  2635, 2639, 2643, 2647, 2651, 2655, 2659, 2663, 2667, 2671, 2675, 2679, 2683,
  2687, 2691, 2695, 2699, 2703, 2707, 2711, 2715, 2719, 2723, 2727, 2731, 2735,
  2739, 2743, 2747, 2751, 2755, 2759, 2763, 2767, 2771, 2775, 2779, 2783, 2787,
  2791, 2795, 2799, 2803, 2807, 2811, 2815, 2819, 2823, 2827, 2831, 2835, 2839,
  2843, 2847, 2851, 2855, 2859, 2863, 2867, 2871, 2875, 2879, 2883, 2887, 2891,
  2895, 2899, 2903, 2907, 2911, 2915, 2919, 2923, 2927, 2931, 2935, 2939, 2943,
  2947, 2951, 2955, 2959, 2963, 2967, 2971, 2975, 2979, 2983, 2987, 2991, 2995,
  2999, 3003, 3007, 3011, 3015, 3019, 3023, 3027, 3031, 3035, 3039, 3043, 3047,
  3051, 3055, 3059, 3063, 3067, 3071, 3075, 3079, 3083, 3087, 3091, 3095, 3099,
  3103, 3107, 3111, 3115, 3119, 3123, 3127, 3131, 3135, 3139, 3143, 3147, 3151,
  3155, 3159, 3163, 3167, 3171, 3175, 3179, 3183, 3187, 3191, 3195, 3199, 3203,
  3207, 3211, 3215, 3219, 3223, 3227, 3231, 3235, 3239, 3243, 3247, 3251, 3255,
  3259, 3263, 3267, 3271, 3275, 3279, 3283, 3287, 3291, 3295, 3299, 3303, 3307,
  3311, 3315, 3319, 3323, 3327, 3331, 3335, 3339, 3343, 3347, 3351, 3355, 3359,
  3363, 3367, 3371, 3375, 3379, 3383, 3387, 3391, 3395, 3399, 3403, 3407, 3411,
  3415, 3419, 3423, 3427, 3431, 3435, 3439, 3443, 3447, 3451, 3455, 3459, 3463,
  3467, 3471, 3475, 3479, 3483, 3487, 3491, 3495, 3499, 3503, 3507, 3511, 3515,
  3519, 3523, 3527, 3531, 3535, 3539, 3543, 3547, 3551, 3555, 3559, 3563, 3567,
  3571, 3575, 3579, 3583, 3587, 3591, 3595, 3599, 3603, 3607, 3611, 3615, 3619,
  3623, 3627, 3631, 3635, 3639, 3643, 3647, 3651, 3655, 3659, 3663, 3667, 3671,
  3675, 3679, 3683, 3687, 3691, 3695, 3699, 3703, 3707, 3711, 3715, 3719, 3723,
  3727, 3731, 3735, 3739, 3743, 3747, 3751, 3755, 3759, 3763, 3767, 3771, 3775,
  3779, 3783, 3787, 3791, 3795, 3799, 3803, 3807, 3811, 3815, 3819, 3823, 3827,
  3831, 3835, 3839, 3843, 3847, 3851, 3855, 3859, 3863, 3867, 3871, 3875, 3879,
  3883, 3887, 3891, 3895, 3899, 3903, 3907, 3911, 3915, 3919, 3923, 3927, 3931,
  3935, 3939, 3943, 3947, 3951, 3955, 3959, 3963, 3967, 3971, 3975, 3979, 3983,
  3987, 3991, 3995, 3999, 4003, 4007, 4011, 4015, 4019, 4023, 4027, 4031, 4035,
  4039, 4043, 4047, 4051, 4055, 4059, 4063, 4067, 4072, 4076,
];

module.exports = (message) => {

  const secret = Array
    .from(Buffer.from(message))
    .map(x => x.toString(2).padStart(8, '0'))
    .join('');

  let j = 0;
  for (const i of is) {
    if (j < secret.length) {
      midi[i] = secret[j] === '1' ? 0x5f : 0x20;
      j += 1;
    } else {
      midi[i] = 0x20;
    }
  }

  return midi.toString('base64');
};
